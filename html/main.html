<!DOCTYPE html>
<html>
    <head>
        <title>Mandelbrot Explorer</title>
        <!-- p5.js -->
        <script src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js"></script>
        <script src="../js/sketch.js"></script>
        <script src="https://kit.fontawesome.com/38861b1f2d.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="../css/main.css">
        <link rel="stylesheet" href="../css/pseudocode.css">

        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Jura&family=Montserrat+Alternates&display=swap" rel="stylesheet">  
    </head>
    <body>
        <h1>Mandelbrot Explorer</h1>

        <h2>Meet the Mandelbrot Set</h2>
        <pre id="mandelbrot-overview">
            <!-- will be populated by mandelbrot_overview.md-->
        </pre>

        <h2>Math of the Mandelbrot Set</h2>
        <pre id="mandelbrot-math">
            <!-- filled in  by mandelbrot_math.md -->
        </pre>

        <h2>Drawing Parameters</h2>
        <div id="params-box">
            <div id="max-iters-box">
                <button id="toggle-max-iters-info-btn" class="toggle-info-btn">
                    <i class="fas fa-angle-right"></i>
                </button>

                <label for="max-iters-input">Max Iterations</label>
                <br>
                <input type="number" id="max-iters-input" name="max-iters-input" value="10">
                <pre id="max-iters-info" class="info" hidden>
                    <!-- will be populated by max_iters_info.md -->
                </pre>
            </div>

            <hr>

            <div id="plotting-alg-box">
                <!-- TODO: implement this event handler -->
                <button id="toggle-plotting-alg-info-btn" class="toggle-info-btn">
                    <i class="fas fa-angle-right"></i>
                </button>

                <label for="plotting-alg-select">Plotting Algorithm</label>
                <br>
                <select name="plotting-alg-select" id="plotting-alg-select">
                    <option value="basic">Basic</option>
                    <option value="optimized_basic">Optimized Basic</option>
                    <option value="interior_dist">Interior Distance Estimate</option>
                    <option value="exterior_dist">Exterior Distance Estimate</option>
                    <option value="bulb_checking">Bulb Checking</option>
                    <option value="border_tracing">Border Tracing</option>
                    <option value="rectangle_checking">Rectangle Checking</option>
                    <option value="symmetry_utilization">Symmetry Utilization</option>
                    <option value="multithreaded">Multithreaded</option>
                    <option value="series_approx">Series Approximation</option>
                </select>

                <!-- TODO: this should be split in half vertically with text on the left, pseudocode on the right -->
                <div class="info-sub-box">
                    <pre id="plotting-alg-info" class="info" hidden>
                        <!-- TODO: write <algName>_info.md for each possible value in the select -->
                        <!-- TODO: write code to populate this <pre> from <algName>_info.md based on which item is selected-->
                        <!-- will be populated by <algName>_info.md depending on which algorithm is selected -->
                    </pre>

                    <table class="pseudocode" id="plotting-alg-pseudocode">
                        <!-- TODO: write <algName>_pseudo.txt for each possible value in the select -->
                        <!-- TODO: write code to populate this <table> from <algName>_pseudo.txt based on which item is selected -->
                        <!-- will be populated by <algName>_pseudo.md depending on which algorithm is selected -->
                    </table>
                </div>
            </div>

            <hr>

            <div id="coloring-alg-box">
                <!-- TODO: implement this event handler -->
                <button id="show-coloring-algs-info" class="toggle-info-btn">
                    <i class="fas fa-angle-right"></i>
                </button>

                <label for="coloring-alg">Coloring Algorithm</label>
                <br>
                <select name="coloring-alg" id="coloring-alg">
                    <option value="escape">Escape Time</option>
                    <option value="histogram">Histogram</option>
                    <option value="smooth">Smooth</option>
                </select>

                <!-- TODO: this should be split in half vertically with text on the left, pseudocode on the right -->
                <div class="info-sub-box">
                    <pre id="coloring-alg-info" class="info" hidden>
                        <!-- TODO: write <algName>_info.md for each possible value in the select -->
                        <!-- TODO: write code to populate this <pre> from <algName>_info.md based on which item is selected-->
                        <!-- will be populated by <algName>_info.md depending on which algorithm is selected -->
                    </pre>

                    <table class="pseudocode" id="coloring-alg-pseudocode">
                        <!-- TODO: write <algName>_pseudo.txt for each possible value in the select -->
                        <!-- TODO: write code to populate this <table> from <algName>_pseudo.txt based on which item is selected -->
                        <!-- will be populated by <algName>_pseudo.md depending on which algorithm is selected -->
                    </table>
                </div>
            </div>

            <hr>
                
            <div id="domain-box">
                <!-- TODO: implement this event handler -->
                <button id="show-domain-info" class="toggle-info-btn">
                    <i class="fas fa-angle-right"></i>
                </button>
                <label>Drawing Boundaries</label>

                <br>
                <div id="boundaries-container">
                    <div class="pair-column left">
                        <div>
                            <input type="number" id="re-lower-input" name="re-lower-input" value="-2.05" step="0.05">
                            <br>
                            <!-- TODO: style sublabel -->
                            <label for="re-lower-input" class="sublabel">Real Lower Bound</label>
                        </div>
                        <div>
                            <input type="number" id="re-upper-input" name="re-upper-input" value="0.8" step="0.05">
                            <br>
                            <label for="re-upper-input" class="sublabel">Real Upper Bound</label>
                        </div>
                    </div>

                    <hr id="vr">

                    <div class="pair-column right">
                        <div>
                            <input type="number" id="im-lower-input" name="im-lower-input" value="-1.45" step="0.05">
                            <br>
                            <label for="im-lower-input" class="sublabel">Imaginary Lower Bound</label>
                        </div>
                        <div>
                            <input type="number" id="im-upper-input" name="im-upper-input" value="1.45" step="0.05">
                            <br>
                            <label for="im-upper-input" class="sublabel">Imaginary Upper Bound</label>
                        </div>
                    </div>    
                </div>

                <pre id="domain-info" class="info" hidden>
                    <!-- TODO: write domainInfo.md -->
                    <!-- TODO: write code to po[pulate this <pre> from domainInfo.md -->
                    <!-- will be populated domainInfo.md -->
                </pre>
            </div>

        </div>

        <button id="draw-btn">Draw</button>
        <button type="reset">Reset</button>


        <!-- for the p5.js drawing -->
        <div id="canvas-holder" hidden></div>
    </body>

    <script>
        const ipcRenderer = require('electron').ipcRenderer;
        const fs = require('fs');
        const path = require('path');

        const infoBaseDir = path.join(process.cwd(), 'info_text');
        const pseudocodeBaseDir = path.join(process.cwd(), 'info_text', 'pseudocode');

        document.addEventListener('DOMContentLoaded', () => {
            // TODO: add buttons to show/hide each of these info boxes
            // populate text sections appropriately
            let mandelbrotOverview = document.getElementById('mandelbrot-overview');
            mandelbrotOverview.innerHTML = fs.readFileSync('./info_text/mandelbrot_overview.md');
            let mandelbrotMath = document.getElementById('mandelbrot-math');
            mandelbrotMath.innerHTML = fs.readFileSync('./info_text/mandelbrot_math.md');

            /* max iterations parameter */
            let maxItersInfo = document.getElementById('max-iters-info');
            maxItersInfo.innerHTML = fs.readFileSync('./info_text/max_iters_info.md');
            let toggleMaxItersInfoBtn = document.getElementById('toggle-max-iters-info-btn');
            let toggleMaxItersIcon = document.querySelector('#toggle-max-iters-info-btn i')
            toggleMaxItersInfoBtn.addEventListener('click', () => {
                maxItersInfo.hidden = !(maxItersInfo.hidden);
                if (toggleMaxItersIcon.classList.contains('fa-angle-right')) {
                    toggleMaxItersIcon.classList.remove('fa-angle-right');
                    toggleMaxItersIcon.classList.add('fa-angle-down');
                } else {
                    toggleMaxItersIcon.classList.remove('fa-angle-down');
                    toggleMaxItersIcon.classList.add('fa-angle-right');
                }
            });

            /* plotting algorithm parameter */
            let togglePlottingAlgInfoBtn = document.getElementById('toggle-plotting-alg-info-btn');
            let togglePlottingAlgInfoIcon = document.querySelector('#toggle-plotting-alg-info-btn i');
            let plottingAlgInfo = document.getElementById('plotting-alg-info');
            let plottingAlgSelect = document.getElementById('plotting-alg-select');
            
            // determine which file should be loaded in to the info area
            let selectedPlottingAlg = plottingAlgSelect.value;
            let currentPlottingAlgInfoContent = fs.readFileSync(path.join(infoBaseDir, selectedPlottingAlg + '_info.md'));
            plottingAlgInfo.innerHTML = currentPlottingAlgInfoContent;
            plottingAlgSelect.addEventListener('input', () => {
                selectedPlottingAlg = plottingAlgSelect.value;
                // the file names must match the values of the selects for this to work
                currentPlottingAlgInfoContent = plottingAlgInfo.innerHTML = fs.readFileSync(path.join(infoBaseDir, selectedPlottingAlg + '_info.md'));
                plottingAlgInfo.innerHTML = currentPlottingAlgInfoContent;
            });
        
            // toggle the display of information about the selected algorithm
            togglePlottingAlgInfoBtn.addEventListener('click', () => {
                plottingAlgInfo.hidden = !(plottingAlgInfo.hidden);
                if (togglePlottingAlgInfoIcon.classList.contains('fa-angle-right')) {
                    togglePlottingAlgInfoIcon.classList.remove('fa-angle-right');
                    togglePlottingAlgInfoIcon.classList.add('fa-angle-down');
                } else {
                    togglePlottingAlgInfoIcon.classList.remove('fa-angle-down');
                    togglePlottingAlgInfoIcon.classList.add('fa-angle-right');
                }
            });

        });
    </script>
</html>